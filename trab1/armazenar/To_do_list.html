<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />
    <title>To Do List</title>
    <link rel="stylesheet" href="estilo.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
  </head>
  <body class="claro">
    <header>
      <h1>Evento</h1>
    </header>
    <main>
        <button type="button" class="btn btn-outline-primary" value='Gravar Lista' id="gravar">gravar lista</button>
        <button type="button" class="btn btn-outline-success" value='Recuperar Lista' id="recuperar">recuperar lista</button>
        <button type="button" class="btn btn-outline-danger" value='Limpar' id="limpar">limpar lista</button>
        <br><br>
        <form action="/action_page.php">
          <div class="mb-3 mt-3">
            <label for="evento" class="form-label">evento:</label>
            <input type="text" class="form-control" id="evento" placeholder="adicionar nome do evento" name="evento">
          </div>
          <div class="mb-3">
            <label for="tema" class="form-label">tema:</label>
            <input type="text" class="form-control" id="tema" placeholder="adicionar tema" name="tema">
          </div>
          <div class="mb-3">
            <label for="local" class="form-label">local:</label>
            <input type="text" class="form-control" id="local" placeholder="adicionar local" name="local">
          </div>
          <div class="mb-3">
            <label for="organizador" class="form-label">organizador(es):</label>
            <input type="text" class="form-control" id="organizador" placeholder="adicionar organizador(es)" name="organizador">
          </div>
          <div class="mb-3">
            <label for="data" class="form-label">data:</label>
            <input type="date" class="form-control" id="data" name="data">
          </div>
        </form>
        <button type="button" class="btn btn-outline-info" value='Adicionar evento' id="adicionar">Info</button><br><br>
      
        <section id="lista">...</section>
    </main>

    
    <script>
      document.querySelector('#adicionar').addEventListener('click', insereevento);
      document.querySelector('#gravar').addEventListener('click', gravar);
      document.querySelector('#recuperar').addEventListener('click', recuperar);
      document.querySelector('#limpar').addEventListener('click', limpar);

      let toDoList=[]; //Variável com os dados da TODO list
      let toDoListold=[];
      function mostra() {
        let valor = "";
        valor+=`pra fazer<br><br>`;
        for (let i = 0; i < toDoList.length; i++) {
          valor += `
          <div class="form-check">
            <input type="radio" class="form-check-input" id="evento${i}" onclick ="excluirevento(${i})" checked>
            <label class="form-check-label" for="evento${i}">${toDoList[i].evento} 
            localizdo em:${toDoList[i].local} 
            tematizado de:${toDoList[i].tema} 
            organizado por:${toDoList[i].organizador} 
            dia:${toDoList[i].data} 
            </label>
          </div>
          `;
        }
        valor+=`<br>feitos<br><br>`;
        for (let i = 0; i < toDoListold.length; i++) {
          valor += `
          <div class="form-check">
            <input type="radio" class="form-check-input" id="eventoold${i}" onclick ="excluirexevento(${i})" checked>
            <label class="form-check-label" for="eventoold${i}">${toDoListold[i].evento} 
            localizdo em:${toDoListold[i].local} 
            tematizado de:${toDoListold[i].tema} 
            organizado por:${toDoListold[i].organizador} 
            dia:${toDoListold[i].data} 
            </label>
            <div class="form-check">
              <input type="radio" class="form-check-input" id="eventoold${i}" onclick ="voltarevento(${i})">
              voltar
            </div>
          </div>
          `;
        }
        document.querySelector("#lista").innerHTML = valor;
      }

      // Inclui e exclui terefas no array toDoList
      function insereevento() {
        toDoList.push(
            {
            evento:document.querySelector("#evento").value,
            organizador:document.querySelector("#organizador").value,
            tema:document.querySelector("#tema").value,
            local:document.querySelector("#local").value,
            data:document.querySelector("#data").value
            }
          );
        mostra();
      }
      function excluirevento(num) {
        toDoListold.push(toDoList[num]);
        toDoList.splice(num, 1);
        mostra();
      }
      function excluirexevento(num) {
        toDoListold.splice(num, 1);
        mostra();
      }
      function voltarevento(num) {
        toDoList.push(toDoListold[num]);
        toDoListold.splice(num, 1);
        mostra();
      }
      //Operações no localstorage
      function gravar ()
      {
        localStorage.setItem("lista",JSON.stringify(toDoList));
        localStorage.setItem("listaold",JSON.stringify(toDoListold));
      }
      function recuperar ()
      {
        toDoList=[];
        lista=localStorage.getItem("lista");
        if(lista){
          toDoList=JSON.parse(lista);
        }
        toDoListold=[];
        listaold=localStorage.getItem("listaold");
        if(listaold){
          toDoListold=JSON.parse(listaold);
        }
        mostra();
      }
      function limpar() {
         localStorage.removeItem('lista');
         toDoList=[];
         localStorage.removeItem('listaold');
         toDoListold=[];
         mostra();
      } 
    </script>
  </body>
</html>